# 测试流程

一般会有: 冒烟测试, 功能测试, 集成测试, 系统测试, 验收测试, 回归测试, 线上巡检这些

常见的流程是: 完成一个新版本开发, 先进行冒烟测试, 测试通过才会进行下一步的功能测试, 集成测试, 系统测试等.

- 冒烟测试, 目的是为了减少软件的测试成本, 试想如果不做冒烟, 直接去做余下的测试, 很可能就会有做着做着做不下去的情况, 因为测试过程中发现最基本的业务功能模块都不可用, 更别说其他功能模块了.
- 回归测试, 一般我们修复一个 bug, 或是上线一个新版本之后, 通常要把之前的测试用例再次应用的修复后的版本上进行测试.
- 线上巡检, 项目上线后, 并不是说就一定没有 bug 了, 上线前测试遗留, 前后端, 运维功能的修改, 都可能会影响到其他的某些功能. 为了保障自身网站的质量与体验, 定期线上巡检势在必行.

# 压测

### 系统性能

性能是系统或组件在给定约束中实现的指定功能的程度, 诸如: 速度, 正确性, 内存使用等. <br />
所以性能测试报告中, 对系统性能的描述应该是多方面的, 如: 执行效率, 稳定性, 兼容性, 可靠性, 可扩展性容量等. 其中执行效率通过并发用户数, 响应时间, 吞吐量, 成功率, 资源消耗综合体现.

### 性能测试

性能测试有: 负载测试, 压力测试, 配置测试, 并发测试, 容量测试, 稳定性测试. 实际压测中, 一般都是设置多个并发, 再进行负载测试, 压力测试等.

- 并发测试: 多个用户同时访问同一个应用, 同一个模块或者数据记录时是否存在死锁或其他性能问题.

### 怎么看并发

- 广义并发: 在一个时间内操作事务的虚拟用户
- 狭义并发: 单位时间内向系统发起请求的虚拟用户
  压力不仅仅受成功发出请求的用户带来的压力, 同时也受存在的用户的影响. 这里广义对应着存在, 狭义对应着请求.
  > 并发计算: C = nL / T (C: 并发, n: 压测时间段内所有的请求数, L: 平局响应时间, T: 压测总时长)

### 压力是什么

压力就是并发在单位时间内对压测对象的请求数. 在压测工具中, 一般都会有一个配置项来专门设置压力, 可能是所有线程产生的总压力, 也可能是单个线程产生的压力.

> 压力并不等同于性能, 比如我们设置了发送 10W 笔/s 的请求, 系统的吞吐量计算只有 1W 笔/s, 这里 10W 笔/s 是压力, 系统的性能是 1W 笔/s. 此外, 在一定压力下, 系统是否能保持正常运转, 如果超过负荷, 会不会进行分流或化解压力, 也是需要检测的.
> 压力是由工具制造的, 有一种情况是, 压测系统还没有到极限, 工具所能施加的最大压力却到极限了, 这时得到的压测数据就是错误的.

### 吞吐量的计算

两种常见的公式:

- 吞吐量 = 并发数 / 平均响应时间
- 吞吐量 = 请求总数 / 总时长
  这两个公式其实是等价的, 可以通过 C = nL / T 推导出 C / L = n / T 得出. <br />
  **但是这两个公式是建立在并发稳定的基础上, 如果并发发生变化, 结果就会有差异**

### 结论

- 单接口压测时, 用 请求时长 / 总时长 得到吞吐量. 然后在用 吞吐量 \* 平均响应时间 得到实际并发, 此举可以用来观察系统实际承受的并发
- 多接口压测时, 由于短板效应, 同一流程中的所有接口获得的请求总数和总时长都一样, 显然 请求总数 / 总时长 计算各个子接口的吞吐量不合适, 所以改用 并发 / 平均响应时间 , 其中并发数应在压测工具中埋点统计, 不可简单使用工具线程数.

> 并发数和吞吐量的单位都是 笔/s
